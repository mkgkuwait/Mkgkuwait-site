<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>تسجيل متطوع</title>

<style>
body{
  background:#0f1b24;
  color:#fff;
  font-family:Tahoma, Arial;
  margin:0;
  padding-bottom:90px; /* مساحة للشريط السفلي */
}
.page{
  max-width:560px;
  margin:30px auto;
  background:#13232f;
  padding:30px;
  border-radius:14px;
}
header{text-align:center;margin-bottom:25px;}
header img{height:95px;} /* تكبير الشعار */
h1{margin:10px 0 5px}
h2{margin:0;font-size:16px;font-weight:normal;color:#ccc}

input,select{
  width:100%;
  padding:14px;
  margin:10px 0;
  border-radius:8px;
  border:none;
  font-size:16px;
}
button{
  padding:14px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  font-size:18px;
}
.submit{
  width:100%;
  background:#c9a24d;
  color:#000;
  margin-top:20px;
}
.consent-box{
  background:#1d3342;
  padding:15px;
  border-radius:8px;
  font-size:15px;
  margin-top:10px;
}
canvas{
  display:block;
  margin-top:10px;
  background:#fff;
  border:1px solid #aaa;
  touch-action:none;
}

/* الشريط السفلي */
.footer-fixed{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:#0b1620;
  display:flex;
  justify-content:space-around;
  align-items:center;
  padding:10px 5px;
  z-index:999;
}
.footer-fixed a{
  color:#fff;
  text-decoration:none;
  font-size:12px;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:4px;
}
.footer-fixed svg{
  width:22px;
  height:22px;
  fill:#c9a24d;
}
</style>
</head>

<body>

<div class="page">
<header>
  <a href="index.html"><img src="logo.png" alt="شعار المحافظة"></a>
  <h1>تسجيل متطوع</h1>
  <h2>Volunteer Registration</h2>
</header>

<form id="volunteerForm">

<input name="Full_Name" required placeholder="الاسم الكامل">
<input name="Volunteer_Phone" required placeholder="رقم هاتف المتطوع">
<input name="Civil_ID" required placeholder="الرقم المدني للمتطوع">

<input type="number" id="age" name="Age" required placeholder="العمر (من 10 إلى 70)">

<select name="Volunteer_Type" required>
  <option value="">اختر مجال التطوع</option>
  <option>الزراعة التجميلية</option>
  <option>صيانة مرافق وخدمات عامة</option>
</select>

<!-- ولي الأمر -->
<div id="guardian" style="display:none">

  <h3>بيانات ولي الأمر</h3>

  <input name="Guardian_Name" placeholder="اسم ولي الأمر">
  <input name="Guardian_Phone" placeholder="رقم هاتف ولي الأمر">
  <input name="Guardian_Civil_ID" placeholder="الرقم المدني لولي الأمر">

  <div class="consent-box">
    <label>
      <input type="checkbox" id="guardianAgree">
      أقر أنا ولي أمر المتقدم بموافقتي الكاملة على مشاركة ابني/ابنتي
      في الأعمال التطوعية التابعة لمحافظة مبارك الكبير وأتحمل كامل
      المسؤولية القانونية.
    </label>
  </div>

  <p><strong>توقيع ولي الأمر:</strong></p>
  <canvas id="sig" width="400" height="160"></canvas>
  <button type="button" onclick="clearSig()">مسح التوقيع</button>

</div>

<button class="submit" type="submit">إرسال</button>
</form>
</div>

<!-- الشريط السفلي الثابت -->
<div class="footer-fixed">
  <a href="https://instagram.com/mkgkuwait">
    <svg viewBox="0 0 24 24"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5z"/></svg>
    Instagram
  </a>
  <a href="https://x.com/mkgkuwait">
    <svg viewBox="0 0 24 24"><path d="M18.9 2H22l-7.2 8.2L23 22h-6.8l-5.3-6.5L5.7 22H2.6l7.7-8.8L1 2h7z"/></svg>
    X
  </a>
  <a href="tel:25473556">
    <svg viewBox="0 0 24 24"><path d="M6.6 10.8a15.1 15.1 0 0 0 6.6 6.6l2.2-2.2z"/></svg>
    اتصال
  </a>
  <a href="mailto:mkgkuwait@outlook.com">
    <svg viewBox="0 0 24 24"><path d="M2 6h20v12H2z"/></svg>
    بريد
  </a>
  <a href="https://maps.app.goo.gl/Uh4Pe6vRAKwXzFHb7">
    <svg viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 5.2 7 13 7 13s7-7.8 7-13a7 7 0 0 0-7-7z"/></svg>
    الموقع
  </a>
</div>

<script>
const age = document.getElementById("age");
const guardian = document.getElementById("guardian");
const agree = document.getElementById("guardianAgree");
const canvas = document.getElementById("sig");
const ctx = canvas.getContext("2d");
let drawing=false;

function prepareCanvas(){
  const r=window.devicePixelRatio||1;
  const w=canvas.width,h=canvas.height;
  canvas.width=w*r; canvas.height=h*r;
  canvas.style.width=w+"px"; canvas.style.height=h+"px";
  ctx.setTransform(r,0,0,r,0,0);
  ctx.fillStyle="#fff"; ctx.fillRect(0,0,w,h);
  ctx.strokeStyle="#000"; ctx.lineWidth=2; ctx.lineCap="round";
}
prepareCanvas();

function pos(e){
  const r=canvas.getBoundingClientRect();
  if(e.touches){
    return {x:e.touches[0].clientX-r.left,y:e.touches[0].clientY-r.top};
  }
  return {x:e.offsetX,y:e.offsetY};
}

function start(e){e.preventDefault();drawing=true;const p=pos(e);ctx.beginPath();ctx.moveTo(p.x,p.y);}
function draw(e){if(!drawing)return;e.preventDefault();const p=pos(e);ctx.lineTo(p.x,p.y);ctx.stroke();}
function stop(){drawing=false;}

canvas.addEventListener("mousedown",start);
canvas.addEventListener("mousemove",draw);
canvas.addEventListener("mouseup",stop);
canvas.addEventListener("mouseleave",stop);
canvas.addEventListener("touchstart",start,{passive:false});
canvas.addEventListener("touchmove",draw,{passive:false});
canvas.addEventListener("touchend",stop);

function clearSig(){ctx.clearRect(0,0,canvas.width,canvas.height);prepareCanvas();}

age.addEventListener("input",()=>{
  const a=parseInt(age.value,10);
  if(a<10){
    alert("العمر أقل من 10 سنوات غير مسموح بالتسجيل");
    age.value="";
    guardian.style.display="none";
    return;
  }
  if(a<=17){
    guardian.style.display="block";
    agree.required=true;
  }else{
    guardian.style.display="none";
    agree.required=false;
    clearSig();
  }
});

document.getElementById("volunteerForm").addEventListener("submit",function(e){
  e.preventDefault();
  const a=parseInt(age.value,10);
  if(a<=17 && !agree.checked){alert("موافقة ولي الأمر مطلوبة");return;}
  const data=new FormData(this);
  if(a<=17){data.append("Guardian_Signature_Base64",canvas.toDataURL("image/png"));}
  fetch("https://script.google.com/macros/s/AKfycbygn8i590rV6sLcHtjZV2HrcUVSE-VILFyrqqj-bvpIotdPMxK9TpNbvSWeGuMtO_YYMA/exec",{method:"POST",body:data})
  .then(()=>location.href="thankyou.html")
  .catch(()=>alert("فشل الإرسال"));
});
</script>

</body>
</html>
