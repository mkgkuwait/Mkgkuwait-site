<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>تسجيل متطوع</title>

<style>
body{
  background:#0f1b24;
  color:#fff;
  font-family:Tahoma, Arial;
  margin:0;
  padding-bottom:80px; /* مساحة للفوتر */
}

/* زر اللغة */
.lang-toggle{
  position:fixed;
  top:15px;
  right:15px;
  z-index:1000;
  background:#c9a24d;
  color:#000;
  border:none;
  padding:8px 14px;
  border-radius:20px;
  font-size:14px;
  cursor:pointer;
}

/* المحتوى */
.page{
  max-width:560px;
  margin:30px auto;
  background:#13232f;
  padding:30px;
  border-radius:14px;
}
header{text-align:center;margin-bottom:25px;}
header img{height:90px;}
h1{margin:10px 0 5px}
h2{margin:0;font-size:15px;color:#ccc}

input,select{
  width:100%;
  padding:14px;
  margin:10px 0;
  border-radius:8px;
  border:none;
  font-size:16px;
}
button.submit{
  width:100%;
  background:#c9a24d;
  color:#000;
  border:none;
  padding:16px;
  border-radius:10px;
  font-size:18px;
  margin-top:20px;
  cursor:pointer;
}

.consent-box{
  background:#1d3342;
  padding:15px;
  border-radius:8px;
  font-size:15px;
  margin-top:10px;
}

canvas{
  width:100%;
  height:160px;
  background:#fff;
  border:1px solid #aaa;
  margin-top:10px;
  touch-action:none;
}

/* الفوتر – نفس الدزاين */
.footer-fixed{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:#000;
  display:flex;
  justify-content:space-around;
  align-items:center;
  padding:14px 0;
  z-index:999;
}
.footer-fixed a svg{
  width:22px;
  height:22px;
  fill:#fff;
}
</style>
</head>

<body>

<button class="lang-toggle" onclick="toggleLang()">AR / EN</button>

<div class="page">
<header>
  <img src="logo.png" alt="logo">
  <h1 data-ar="تسجيل متطوع" data-en="Volunteer Registration">تسجيل متطوع</h1>
  <h2 data-ar="محافظة مبارك الكبير" data-en="Mubarak Al-Kabeer Governorate">
    محافظة مبارك الكبير
  </h2>
</header>

<form id="volunteerForm">

<input name="Full_Name" required placeholder="الاسم الكامل">
<input name="Volunteer_Phone" required placeholder="رقم هاتف المتطوع">
<input name="Civil_ID" required placeholder="الرقم المدني للمتطوع">

<input type="number" id="age" name="Age" placeholder="العمر (10 – 70)" required>

<select name="Volunteer_Type" required>
  <option value="">اختر مجال التطوع</option>
  <option>الزراعة التجميلية</option>
  <option>صيانة مرافق وخدمات عامة</option>
</select>

<div id="guardian" style="display:none">

  <h3>بيانات ولي الأمر</h3>
  <input name="Guardian_Name" placeholder="اسم ولي الأمر">
  <input name="Guardian_Phone" placeholder="رقم هاتف ولي الأمر">
  <input name="Guardian_Civil_ID" placeholder="الرقم المدني لولي الأمر">

  <div class="consent-box">
    <label>
      <input type="checkbox" id="guardianAgree">
      أقر أنا ولي أمر المتقدم بموافقتي الكاملة على المشاركة وأتحمل المسؤولية القانونية.
    </label>
  </div>

  <p><strong>توقيع ولي الأمر:</strong></p>
  <canvas id="sig"></canvas>
  <button type="button" onclick="clearSig()">مسح التوقيع</button>
</div>

<button class="submit" type="submit">إرسال</button>
</form>
</div>

<!-- الفوتر الثابت -->
<div class="footer-fixed">
  <a href="https://maps.app.goo.gl/Uh4Pe6vRAKwXzFHb7">
    <svg viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 5.2 7 13 7 13s7-7.8 7-13z"/></svg>
  </a>
  <a href="mailto:mkgkuwait@outlook.com">
    <svg viewBox="0 0 24 24"><path d="M2 6h20v12H2z"/></svg>
  </a>
  <a href="tel:25473556">
    <svg viewBox="0 0 24 24"><path d="M6.6 10.8a15.1 15.1 0 0 0 6.6 6.6z"/></svg>
  </a>
  <a href="https://x.com/mkgkuwait">
    <svg viewBox="0 0 24 24"><path d="M18.9 2H22l-7.2 8.2L23 22h-6.8z"/></svg>
  </a>
  <a href="https://instagram.com/mkgkuwait">
    <svg viewBox="0 0 24 24"><path d="M7 2h10a5 5 0 0 1 5 5v10z"/></svg>
  </a>
</div>

<script>
/* ===== اللغة ===== */
const LANG_KEY="site_lang";
function toggleLang(){
  const l=(localStorage.getItem(LANG_KEY)||"ar")==="ar"?"en":"ar";
  setLang(l);
}
function setLang(l){
  localStorage.setItem(LANG_KEY,l);
  document.documentElement.dir=l==="ar"?"rtl":"ltr";
  document.querySelectorAll("[data-ar]").forEach(el=>{
    el.textContent = l==="ar"?el.dataset.ar:el.dataset.en;
  });
}
setLang(localStorage.getItem(LANG_KEY)||"ar");

/* ===== العمر ===== */
const age=document.getElementById("age");
const guardian=document.getElementById("guardian");
const agree=document.getElementById("guardianAgree");

age.addEventListener("blur",()=>{
  const a=parseInt(age.value,10);
  if(isNaN(a)) return;

  if(a<10){
    alert("العمر أقل من 10 سنوات غير مسموح");
    age.value="";
    guardian.style.display="none";
    return;
  }
  guardian.style.display = a<=17 ? "block" : "none";
  agree.required = a<=17;
});

/* ===== التوقيع (يدعم آيفون) ===== */
const canvas=document.getElementById("sig");
const ctx=canvas.getContext("2d");
let drawing=false;

function resizeCanvas(){
  const r=window.devicePixelRatio||1;
  canvas.width=canvas.offsetWidth*r;
  canvas.height=160*r;
  ctx.scale(r,r);
  ctx.fillStyle="#fff";
  ctx.fillRect(0,0,canvas.offsetWidth,160);
  ctx.strokeStyle="#000";
  ctx.lineWidth=2;
}
resizeCanvas();

function pos(e){
  const r=canvas.getBoundingClientRect();
  const t=e.touches?e.touches[0]:e;
  return {x:t.clientX-r.left,y:t.clientY-r.top};
}
canvas.addEventListener("mousedown",e=>{drawing=true;ctx.beginPath();const p=pos(e);ctx.moveTo(p.x,p.y);});
canvas.addEventListener("mousemove",e=>{if(!drawing)return;const p=pos(e);ctx.lineTo(p.x,p.y);ctx.stroke();});
["mouseup","mouseleave"].forEach(e=>canvas.addEventListener(e,()=>drawing=false));

canvas.addEventListener("touchstart",e=>{e.preventDefault();drawing=true;const p=pos(e);ctx.beginPath();ctx.moveTo(p.x,p.y);},{passive:false});
canvas.addEventListener("touchmove",e=>{e.preventDefault();if(!drawing)return;const p=pos(e);ctx.lineTo(p.x,p.y);ctx.stroke();},{passive:false});
canvas.addEventListener("touchend",()=>drawing=false);

function clearSig(){resizeCanvas();}

/* ===== الإرسال ===== */
document.getElementById("volunteerForm").addEventListener("submit",e=>{
  e.preventDefault();
  const a=parseInt(age.value,10);
  if(a<=17 && !agree.checked){alert("موافقة ولي الأمر مطلوبة");return;}
  const data=new FormData(e.target);
  if(a<=17) data.append("Guardian_Signature_Base64",canvas.toDataURL("image/png"));

  fetch("https://script.google.com/macros/s/AKfycbygn8i590rV6sLcHtjZV2HrcUVSE-VILFyrqqj-bvpIotdPMxK9TpNbvSWeGuMtO_YYMA/exec",
    {method:"POST",body:data})
    .then(()=>location.href="thankyou.html")
    .catch(()=>alert("فشل الإرسال"));
});
</script>

</body>
</html>
